<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Week 2a - Interactivity Shop</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    .topbar { display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; }
    .tabs button { margin-right: 8px; padding: 6px 10px; }
    .active { background: #222; color: #fff; }
    .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 12px; }
    .card { border: 1px solid #ddd; padding: 12px; border-radius: 6px; }
    .muted { color: #777; }
    table { border-collapse: collapse; width: 100%; }
    th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
    th { background: #f5f5f5; }
  </style>
</head>
<body>
  <div class="topbar">
    <h2>Mini Shop</h2>
    <div>Cart items: <strong id="cartCount">0</strong></div>
  </div>

  <div class="tabs">
    <button id="tabProducts" class="active">Products</button>
    <button id="tabCheckout">Checkout</button>
  </div>

  <section id="viewProducts">
    <div class="grid" id="productGrid"></div>
  </section>

  <section id="viewCheckout" style="display:none">
    <h3>Checkout</h3>
    <p class="muted">Review items below. Remove items or proceed.</p>
    <table id="cartTable">
      <thead>
        <tr><th>Product</th><th>Qty</th><th>Actions</th></tr>
      </thead>
      <tbody id="cartBody">
        <tr><td colspan="3" class="muted">Cart is empty</td></tr>
      </tbody>
    </table>
  </section>

  <script>
    // Inventory with limited stock
    const inventory = [
      { id: 1, name: 'Tâ€‘Shirt', stock: 3 },
      { id: 2, name: 'Jeans', stock: 2 },
      { id: 3, name: 'Sneakers', stock: 1 },
      { id: 4, name: 'Cap', stock: 5 }
    ];

    // Cart: map of productId -> quantity
    const cart = {};

    // Elements
    const productGrid = document.getElementById('productGrid');
    const cartCountEl = document.getElementById('cartCount');
    const cartBody = document.getElementById('cartBody');
    const viewProducts = document.getElementById('viewProducts');
    const viewCheckout = document.getElementById('viewCheckout');
    const tabProducts = document.getElementById('tabProducts');
    const tabCheckout = document.getElementById('tabCheckout');

    // Render products with "Add to cart" and stock
    function renderProducts() {
      productGrid.innerHTML = '';
      inventory.forEach(item => {
        const inCart = cart[item.id] || 0;
        const remaining = item.stock - inCart;
        const card = document.createElement('div');
        card.className = 'card';
        card.innerHTML = `
          <h4>${item.name}</h4>
          <p class="muted">In stock: ${remaining}</p>
          <button ${remaining <= 0 ? 'disabled' : ''} data-id="${item.id}">
            ${remaining > 0 ? 'Add to cart' : 'Out of stock'}
          </button>
        `;
        const btn = card.querySelector('button');
        btn.addEventListener('click', () => addToCart(item.id));
        productGrid.appendChild(card);
      });
    }

    // Add item if stock available
    function addToCart(id) {
      const item = inventory.find(p => p.id === id);
      const inCart = cart[id] || 0;
      if (inCart < item.stock) {
        cart[id] = inCart + 1;
        updateCartCount();
        renderProducts();
        renderCart();
      }
    }

    // Remove one from cart
    function removeOne(id) {
      if (!cart[id]) return;
      cart[id] -= 1;
      if (cart[id] <= 0) delete cart[id];
      updateCartCount();
      renderProducts();
      renderCart();
    }

    // Update cart count display
    function updateCartCount() {
      const count = Object.values(cart).reduce((a, b) => a + b, 0);
      cartCountEl.textContent = count;
    }

    // Render cart table
    function renderCart() {
      const ids = Object.keys(cart);
      if (ids.length === 0) {
        cartBody.innerHTML = '<tr><td colspan="3" class="muted">Cart is empty</td></tr>';
        return;
      }
      cartBody.innerHTML = '';
      ids.forEach(id => {
        const qty = cart[id];
        const item = inventory.find(p => p.id === Number(id));
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${item.name}</td>
          <td>${qty}</td>
          <td>
            <button data-id="${id}" class="minus">-</button>
            <button data-id="${id}" class="plus">+</button>
          </td>
        `;
        tr.querySelector('.minus').addEventListener('click', () => removeOne(Number(id)));
        tr.querySelector('.plus').addEventListener('click', () => addToCart(Number(id)));
        cartBody.appendChild(tr);
      });
    }

    // Switch views
    function showProducts() {
      viewProducts.style.display = '';
      viewCheckout.style.display = 'none';
      tabProducts.classList.add('active');
      tabCheckout.classList.remove('active');
    }
    function showCheckout() {
      viewProducts.style.display = 'none';
      viewCheckout.style.display = '';
      tabCheckout.classList.add('active');
      tabProducts.classList.remove('active');
    }

    tabProducts.addEventListener('click', showProducts);
    tabCheckout.addEventListener('click', showCheckout);

    // Initial render
    renderProducts();
    renderCart();
    updateCartCount();
  </script>
</body>
</html>
